diff --git a/source3/lib/util_sock.c b/source3/lib/util_sock.c
index 85dc3ef..bbdc6d8 100644
--- a/source3/lib/util_sock.c
+++ b/source3/lib/util_sock.c
@@ -954,6 +954,12 @@ int create_pipe_sock(const char *socket_dir,
                 goto out_close;
 	}
 
+	/* CVE-2023-3961 - socket names must not contain .. or '/' */
+	if (ISDOTDOT(socket_name) || strchr(socket_name, '/')!=NULL) {
+		errno = ENOENT;
+		goto out_close;
+	}
+
 	if (asprintf(&path, "%s/%s", socket_dir, socket_name) == -1) {
                 goto out_close;
 	}
